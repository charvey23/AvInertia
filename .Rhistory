q_dot_plot <- ggplot()+
geom_point(data = dat_all, aes(x = full_m, y = prop_q_dot*full_Iyy/(full_m*torso_length), col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
dat_all$del_M_specific <- dat_all$prop_q_dot*dat_all$full_Iyy/(dat_all$full_m*dat_all$torso_length)
del_M_plot <- ggplot()+
geom_point(data = dat_all, aes(x = full_m, y = del_M_specific, col = species)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
del_M_plot
path_data_folder = "/Users/christinaharvey/Dropbox (University of Michigan)/Bird Mass Distribution/outputdata/"
filename_wing = list.files(path = path_data_folder, pattern = paste("allspecimen_winginfo"))
dat_wing      = read.csv(file = paste(path_data_folder,filename_wing,sep= ""))
## TO CHECK DATA
# x_vertices = c(dat_wing$pt1_X[i], dat_wing$pt6_X[i],dat_wing$pt7_X[i],dat_wing$pt8_X[i],dat_wing$pt9_X[i],dat_wing$pt10_X[i],dat_wing$pt11_X[i],dat_wing$pt12_X[i])
# y_vertices = c(dat_wing$pt1_Y[i], dat_wing$pt6_Y[i],dat_wing$pt7_Y[i],dat_wing$pt8_Y[i],dat_wing$pt9_Y[i],dat_wing$pt10_Y[i],dat_wing$pt11_Y[i],dat_wing$pt12_Y[i])
# z_vertices = c(dat_wing$pt1_Z[i], dat_wing$pt6_Z[i],dat_wing$pt7_Z[i],dat_wing$pt8_Z[i],dat_wing$pt9_Z[i],dat_wing$pt10_Z[i],dat_wing$pt11_Z[i],dat_wing$pt12_Z[i])
# x = c(dat_wing$pt1_X[m],dat_wing$pt2_X[m],dat_wing$pt3_X[m],dat_wing$pt4_X[m],
#       dat_wing$pt6_X[m],dat_wing$pt7_X[m],dat_wing$pt8_X[m],dat_wing$pt9_X[m],
#       dat_wing$pt10_X[m],dat_wing$pt11_X[m],dat_wing$pt12_X[m])
# y = c(dat_wing$pt1_Y[m],dat_wing$pt2_Y[m],dat_wing$pt3_Y[m],dat_wing$pt4_Y[m],
#       dat_wing$pt6_Y[m],dat_wing$pt7_Y[m],dat_wing$pt8_Y[m],dat_wing$pt9_Y[m],
#       dat_wing$pt10_Y[m],dat_wing$pt11_Y[m],dat_wing$pt12_Y[m])
# z = c(dat_wing$pt1_Z[m],dat_wing$pt2_Z[m],dat_wing$pt3_Z[m],dat_wing$pt4_Z[m],
#       dat_wing$pt6_Z[m],dat_wing$pt7_Z[m],dat_wing$pt8_Z[m],dat_wing$pt9_Z[m],
#       dat_wing$pt10_Z[m],dat_wing$pt11_Z[m],dat_wing$pt12_Z[m])
# plot3d(x, y, z, col = c("black","gray20","gray50","gray70","red", "orange", "yellow", "green", "blue", "navy", "purple"))
filename_feat = list.files(path = path_data_folder, pattern = paste("allspecimen_featherinfo"))
dat_feat      = read.csv(file = paste(path_data_folder,filename_feat,sep= ""))
dat_feat      = dat_feat[,-c(1,3:7)]
filename_bird = list.files(path = path_data_folder, pattern = paste("allspecimen_birdinfo"))
dat_bird      = read.csv(file = paste(path_data_folder,filename_bird,sep= ""))
dat_bird$clade <- c("Accipitriformes","Accipitriformes","Galloanserae","Galloanserae","Aequorlitornithes","Aequorlitornithes","Strisores","Strisores",
"Galloanserae","Columbaves","Columbaves","Columbaves","Passeriformes","Passeriformes","Passeriformes","Passeriformes","Strisores",
"Australaves","Australaves","Australaves","Australaves","Galloanserae","Galloanserae","Coraciimorphae","Coraciimorphae",
"Coraciimorphae","Aequorlitornithes","Aequorlitornithes","Strigiformes","Strigiformes")
filename_body = list.files(path = path_data_folder, pattern = paste("bodyCGandMOI"))
dat_body      = read.csv(file = paste(path_data_folder,filename_body,sep= ""))
dat_body <- reshape2::dcast(dat_body, species + BirdID + TestID + FrameID ~ component + object, value.var="value")
remove(filename_wing,filename_feat,filename_bird,filename_body)
filename_results = list.files(path = path_data_folder, pattern = paste("results"))
dat_results = read.csv(paste(path_data_folder,filename_results[1],sep=""))
for (i in 2:length(filename_results)){
dat_results = rbind(dat_results,read.csv(paste(path_data_folder,filename_results[i],sep="")))
}
# adjust the sharp-shinned hawk 20_1016 to a coopers hawk
dat_wing$species[which(dat_wing$species == "acc_str" & dat_wing$BirdID == "20_1016")] = "acc_coo"
dat_body$species[which(dat_body$species == "acc_str" & dat_body$BirdID == "20_1016")] = "acc_coo"
# remove wings where they accidentally got flipped around 44 from chr_amh and 7 from oce_leu CHECK THIS as you add more
dat_results[which(dat_wing$pt2_X > 0 & dat_wing$species == "chr_amh")]
# Merge with all info we have about the individual
dat_all <- merge(dat_results,dat_wing[,c("species","BirdID","TestID","FrameID","elbow","manus","pt1_X","pt1_Z",
"pt6_X","pt6_Y","pt7_X","pt7_Y","pt8_X","pt8_Y","pt9_X","pt9_Y","pt10_X","pt10_Y",
"pt11_X","pt11_Y","pt11_Z","pt12_X","pt12_Y","pt12_Z")], by = c("species","BirdID","TestID","FrameID"))
dat_all <- merge(dat_all,dat_body[,-c(3,4)], by = c("species","BirdID"))
dat_all <- merge(dat_all,dat_bird[,-c(1,4)], by = c("species","BirdID"))
dat_all$torso_length <- dat_all$torsotail_length - dat_all$tail_length
# Adjust the calculations accordingly
dat_all$full_VRP_Ixx <- dat_all$head_Ixx+dat_all$neck_Ixx+dat_all$tail_Ixx+dat_all$torso_Ixx+2*dat_all$wing_Ixx
dat_all$full_VRP_Iyy <- dat_all$head_Iyy+dat_all$neck_Iyy+dat_all$tail_Iyy+dat_all$torso_Iyy+2*dat_all$wing_Iyy
dat_all$full_VRP_Izz <- dat_all$head_Izz+dat_all$neck_Izz+dat_all$tail_Izz+dat_all$torso_Izz+2*dat_all$wing_Izz
dat_all$full_VRP_Ixz <- dat_all$head_Ixz+dat_all$neck_Ixz+dat_all$tail_Ixz+dat_all$torso_Ixz+2*dat_all$wing_Ixz
dat_all$full_CGx <- ((dat_all$head_CGx*dat_all$head_m)+(dat_all$neck_CGx*dat_all$neck_m)+(dat_all$tail_CGx*dat_all$tail_m)+
(dat_all$torso_CGx*dat_all$torso_m)+2*(dat_all$wing_CGx*dat_all$wing_m))/dat_all$full_m
dat_all$full_CGz <- ((dat_all$head_CGz*dat_all$head_m)+(dat_all$neck_CGz*dat_all$neck_m)+(dat_all$tail_CGz*dat_all$tail_m)+
(dat_all$torso_CGz*dat_all$torso_m)+2*(dat_all$wing_CGz*dat_all$wing_m))/dat_all$full_m
dat_all$S_proj <- 0
for(i in 1:nrow(dat_all)){
I_vrp = matrix(0, nrow = 3, ncol = 3)
I_vrp[1,1] = dat_all$full_VRP_Ixx[i]
I_vrp[2,2] = dat_all$full_VRP_Iyy[i]
I_vrp[3,3] = dat_all$full_VRP_Izz[i]
I_vrp[3,1] = dat_all$full_VRP_Ixz[i]
I_vrp[1,3] = dat_all$full_VRP_Ixz[i]
CG = c(dat_all$full_CGx[i], 0, dat_all$full_CGz[i])
I = parallelaxis(I_vrp,-CG,dat_all$full_m[i],"A")
dat_all$full_Ixx[i] = I[1,1]
dat_all$full_Iyy[i] = I[2,2]
dat_all$full_Izz[i] = I[3,3]
dat_all$full_Ixz[i] = I[3,1]
# Calculate the projected area for each wing - this is the correct order because X is negative and Y is positive
x_vertices = c(dat_all$pt6_X[i],dat_all$pt7_X[i],dat_all$pt8_X[i],dat_all$pt9_X[i],dat_all$pt10_X[i],dat_all$pt11_X[i],dat_all$pt12_X[i])
y_vertices = c(dat_all$pt6_Y[i],dat_all$pt7_Y[i],dat_all$pt8_Y[i],dat_all$pt9_Y[i],dat_all$pt10_Y[i],dat_all$pt11_Y[i],dat_all$pt12_Y[i])
dat_all$S_proj[i] <- polyarea(x_vertices, y_vertices)
}
which(dat_wing$pt2_X > 0 & dat_wing$species == "chr_amh")
library(pracma)
library(ggplot2)
th <- ggplot2::theme_classic() +
ggplot2::theme(
# Text
axis.title  = ggplot2::element_text(size = 10),
axis.text   = ggplot2::element_text(size = 10, colour = "black"),
axis.text.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, unit = "pt")),
axis.text.y = ggplot2::element_text(margin = ggplot2::margin(r = 10)),
# Axis line
axis.line   = ggplot2::element_blank(),
axis.ticks.length = ggplot2::unit(-5,"pt"),
# Background transparency
# Background of panel
panel.background = ggplot2::element_rect(fill = "transparent"),
# Background behind actual data points
plot.background  = ggplot2::element_rect(fill = "transparent", color = NA))
## TO CHECK DATA
# x_vertices = c(dat_wing$pt1_X[i], dat_wing$pt6_X[i],dat_wing$pt7_X[i],dat_wing$pt8_X[i],dat_wing$pt9_X[i],dat_wing$pt10_X[i],dat_wing$pt11_X[i],dat_wing$pt12_X[i])
# y_vertices = c(dat_wing$pt1_Y[i], dat_wing$pt6_Y[i],dat_wing$pt7_Y[i],dat_wing$pt8_Y[i],dat_wing$pt9_Y[i],dat_wing$pt10_Y[i],dat_wing$pt11_Y[i],dat_wing$pt12_Y[i])
# z_vertices = c(dat_wing$pt1_Z[i], dat_wing$pt6_Z[i],dat_wing$pt7_Z[i],dat_wing$pt8_Z[i],dat_wing$pt9_Z[i],dat_wing$pt10_Z[i],dat_wing$pt11_Z[i],dat_wing$pt12_Z[i])
# x = c(dat_wing$pt1_X[m],dat_wing$pt2_X[m],dat_wing$pt3_X[m],dat_wing$pt4_X[m],
#       dat_wing$pt6_X[m],dat_wing$pt7_X[m],dat_wing$pt8_X[m],dat_wing$pt9_X[m],
#       dat_wing$pt10_X[m],dat_wing$pt11_X[m],dat_wing$pt12_X[m])
# y = c(dat_wing$pt1_Y[m],dat_wing$pt2_Y[m],dat_wing$pt3_Y[m],dat_wing$pt4_Y[m],
#       dat_wing$pt6_Y[m],dat_wing$pt7_Y[m],dat_wing$pt8_Y[m],dat_wing$pt9_Y[m],
#       dat_wing$pt10_Y[m],dat_wing$pt11_Y[m],dat_wing$pt12_Y[m])
# z = c(dat_wing$pt1_Z[m],dat_wing$pt2_Z[m],dat_wing$pt3_Z[m],dat_wing$pt4_Z[m],
#       dat_wing$pt6_Z[m],dat_wing$pt7_Z[m],dat_wing$pt8_Z[m],dat_wing$pt9_Z[m],
#       dat_wing$pt10_Z[m],dat_wing$pt11_Z[m],dat_wing$pt12_Z[m])
# plot3d(x, y, z, col = c("black","gray20","gray50","gray70","red", "orange", "yellow", "green", "blue", "navy", "purple"))
# --------------------- Read in data -----------------------
# CAUTION: All incoming measurements must be in SI units; adjust as required
# UPDATE REQUIRED: Should probably move final run files into the bird moment folder
path_data_folder = "/Users/christinaharvey/Dropbox (University of Michigan)/Bird Mass Distribution/outputdata/"
filename_wing = list.files(path = path_data_folder, pattern = paste("allspecimen_winginfo"))
dat_wing      = read.csv(file = paste(path_data_folder,filename_wing,sep= ""))
filename_feat = list.files(path = path_data_folder, pattern = paste("allspecimen_featherinfo"))
dat_feat      = read.csv(file = paste(path_data_folder,filename_feat,sep= ""))
dat_feat      = dat_feat[,-c(1,3:7)]
filename_bird = list.files(path = path_data_folder, pattern = paste("allspecimen_birdinfo"))
dat_bird      = read.csv(file = paste(path_data_folder,filename_bird,sep= ""))
dat_bird$clade <- c("Accipitriformes","Accipitriformes","Galloanserae","Galloanserae","Aequorlitornithes","Aequorlitornithes","Strisores","Strisores",
"Galloanserae","Columbaves","Columbaves","Columbaves","Passeriformes","Passeriformes","Passeriformes","Passeriformes","Strisores",
"Australaves","Australaves","Australaves","Australaves","Galloanserae","Galloanserae","Coraciimorphae","Coraciimorphae",
"Coraciimorphae","Aequorlitornithes","Aequorlitornithes","Strigiformes","Strigiformes")
filename_body = list.files(path = path_data_folder, pattern = paste("bodyCGandMOI"))
dat_body      = read.csv(file = paste(path_data_folder,filename_body,sep= ""))
dat_body <- reshape2::dcast(dat_body, species + BirdID + TestID + FrameID ~ component + object, value.var="value")
remove(filename_wing,filename_feat,filename_bird,filename_body)
filename_results = list.files(path = path_data_folder, pattern = paste("results"))
dat_results = read.csv(paste(path_data_folder,filename_results[1],sep=""))
for (i in 2:length(filename_results)){
dat_results = rbind(dat_results,read.csv(paste(path_data_folder,filename_results[i],sep="")))
}
# adjust the sharp-shinned hawk 20_1016 to a coopers hawk
dat_wing$species[which(dat_wing$species == "acc_str" & dat_wing$BirdID == "20_1016")] = "acc_coo"
dat_body$species[which(dat_body$species == "acc_str" & dat_body$BirdID == "20_1016")] = "acc_coo"
# remove wings where they accidentally got flipped around 44 from chr_amh and 7 from oce_leu CHECK THIS as you add more
# dat_results[which(dat_wing$pt2_X > 0 & dat_wing$species == "chr_amh")]
# Merge with all info we have about the individual
dat_all <- merge(dat_results,dat_wing[,c("species","BirdID","TestID","FrameID","elbow","manus","pt1_X","pt1_Z",
"pt6_X","pt6_Y","pt7_X","pt7_Y","pt8_X","pt8_Y","pt9_X","pt9_Y","pt10_X","pt10_Y",
"pt11_X","pt11_Y","pt11_Z","pt12_X","pt12_Y","pt12_Z")], by = c("species","BirdID","TestID","FrameID"))
dat_all <- merge(dat_all,dat_body[,-c(3,4)], by = c("species","BirdID"))
dat_all <- merge(dat_all,dat_bird[,-c(1,4)], by = c("species","BirdID"))
dat_all$torso_length <- dat_all$torsotail_length - dat_all$tail_length
# Adjust the calculations accordingly
dat_all$full_VRP_Ixx <- dat_all$head_Ixx+dat_all$neck_Ixx+dat_all$tail_Ixx+dat_all$torso_Ixx+2*dat_all$wing_Ixx
dat_all$full_VRP_Iyy <- dat_all$head_Iyy+dat_all$neck_Iyy+dat_all$tail_Iyy+dat_all$torso_Iyy+2*dat_all$wing_Iyy
dat_all$full_VRP_Izz <- dat_all$head_Izz+dat_all$neck_Izz+dat_all$tail_Izz+dat_all$torso_Izz+2*dat_all$wing_Izz
dat_all$full_VRP_Ixz <- dat_all$head_Ixz+dat_all$neck_Ixz+dat_all$tail_Ixz+dat_all$torso_Ixz+2*dat_all$wing_Ixz
dat_all$full_CGx <- ((dat_all$head_CGx*dat_all$head_m)+(dat_all$neck_CGx*dat_all$neck_m)+(dat_all$tail_CGx*dat_all$tail_m)+
(dat_all$torso_CGx*dat_all$torso_m)+2*(dat_all$wing_CGx*dat_all$wing_m))/dat_all$full_m
dat_all$full_CGz <- ((dat_all$head_CGz*dat_all$head_m)+(dat_all$neck_CGz*dat_all$neck_m)+(dat_all$tail_CGz*dat_all$tail_m)+
(dat_all$torso_CGz*dat_all$torso_m)+2*(dat_all$wing_CGz*dat_all$wing_m))/dat_all$full_m
dat_all$S_proj <- 0
for(i in 1:nrow(dat_all)){
I_vrp = matrix(0, nrow = 3, ncol = 3)
I_vrp[1,1] = dat_all$full_VRP_Ixx[i]
I_vrp[2,2] = dat_all$full_VRP_Iyy[i]
I_vrp[3,3] = dat_all$full_VRP_Izz[i]
I_vrp[3,1] = dat_all$full_VRP_Ixz[i]
I_vrp[1,3] = dat_all$full_VRP_Ixz[i]
CG = c(dat_all$full_CGx[i], 0, dat_all$full_CGz[i])
I = parallelaxis(I_vrp,-CG,dat_all$full_m[i],"A")
dat_all$full_Ixx[i] = I[1,1]
dat_all$full_Iyy[i] = I[2,2]
dat_all$full_Izz[i] = I[3,3]
dat_all$full_Ixz[i] = I[3,1]
# Calculate the projected area for each wing - this is the correct order because X is negative and Y is positive
x_vertices = c(dat_all$pt6_X[i],dat_all$pt7_X[i],dat_all$pt8_X[i],dat_all$pt9_X[i],dat_all$pt10_X[i],dat_all$pt11_X[i],dat_all$pt12_X[i])
y_vertices = c(dat_all$pt6_Y[i],dat_all$pt7_Y[i],dat_all$pt8_Y[i],dat_all$pt9_Y[i],dat_all$pt10_Y[i],dat_all$pt11_Y[i],dat_all$pt12_Y[i])
dat_all$S_proj[i] <- polyarea(x_vertices, y_vertices)
}
# Maximum projected wing area
test     <- aggregate(S_proj_max = dat_all$S_proj,  by=list(species = dat_all$species, BirdID = dat_all$BirdID), max)
# Maximum projected wing area
test     <- aggregate(S_proj_max = dat_all$S_proj,  by=list(species = dat_all$species, BirdID = dat_all$BirdID), max)
# Maximum projected wing area
test     <- aggregate(S_proj_max = dat_all$S_proj,  by=list(species = dat_all$species, BirdID = dat_all$BirdID), FUN = max)
# Maximum projected wing area
test     <- aggregate(list(S_proj_max = dat_all$S_proj),  by=list(species = dat_all$species, BirdID = dat_all$BirdID), max)
test
aggregate( dat_all$S_proj,  by=list(species = dat_all$species, BirdID = dat_all$BirdID), max)
test     <- aggregate(list(range_CGx_specific = dat_all$full_CGx_specific),  by=list(species = dat_all$species, BirdID = dat_all$BirdID), FUN=function(x){max(x)-min(x)})
dat_bird <- merge(dat_bird,test, by = c("species","BirdID"))
# Maximum of CGx specific
test     <- aggregate(list(max_CGx_specific = dat_all$full_CGx_specific),  by=list(species = dat_all$species, BirdID = dat_all$BirdID), max)
dat_bird <- merge(dat_bird,test, by = c("species","BirdID"))
# Minimum of CGx specific
test     <- aggregate(list(min_CGx_specific = dat_all$full_CGx_specific),  by=list(species = dat_all$species, BirdID = dat_all$BirdID), min)
dat_bird <- merge(dat_bird,test, by = c("species","BirdID"))
# Range of CGz specific
test     <- aggregate(list(range_CGz_specific = dat_all$full_CGz_specific),  by=list(species = dat_all$species, BirdID = dat_all$BirdID), FUN=function(x){max(x)-min(x)})
dat_bird <- merge(dat_bird,test, by = c("species","BirdID"))
# Maximum of CGz specific
test     <- aggregate(list(max_CGz_specific = dat_all$full_CGz_specific),  by=list(species = dat_all$species, BirdID = dat_all$BirdID), max)
dat_bird <- merge(dat_bird,test, by = c("species","BirdID"))
# Minimum of CGz specific
test     <- aggregate(list(min_CGz_specific = dat_all$full_CGz_specific),  by=list(species = dat_all$species, BirdID = dat_all$BirdID), min)
dat_bird <- merge(dat_bird,test, by = c("species","BirdID"))
test     <- aggregate(list(S_proj_max = dat_all$S_proj),  by=list(species = dat_all$species, BirdID = dat_all$BirdID), max)
dat_bird <- merge(dat_bird[,-c(1)],test, by = c("species","BirdID"))
dat_all  <- merge(dat_all,test, by = c("species","BirdID"))
View(dat_bird)
filename_bird = list.files(path = path_data_folder, pattern = paste("allspecimen_birdinfo"))
dat_bird      = read.csv(file = paste(path_data_folder,filename_bird,sep= ""))
dat_bird$clade <- c("Accipitriformes","Accipitriformes","Galloanserae","Galloanserae","Aequorlitornithes","Aequorlitornithes","Strisores","Strisores",
"Galloanserae","Columbaves","Columbaves","Columbaves","Passeriformes","Passeriformes","Passeriformes","Passeriformes","Strisores",
"Australaves","Australaves","Australaves","Australaves","Galloanserae","Galloanserae","Coraciimorphae","Coraciimorphae",
"Coraciimorphae","Aequorlitornithes","Aequorlitornithes","Strigiformes","Strigiformes")
View(dat_all)
# Maximum projected wing area
test     <- aggregate(list(S_proj_max = dat_all$S_proj),  by=list(species = dat_all$species, BirdID = dat_all$BirdID), max)
dat_bird <- merge(dat_bird[,-c(1)],test, by = c("species","BirdID"))
# Maximum of wing Ixx
test     <- aggregate(list(max_wing_Ixx = dat_all$wing_Ixx),  by=list(species = dat_all$species, BirdID = dat_all$BirdID), max)
dat_bird <- merge(dat_bird,test, by = c("species","BirdID"))
# Mean "root chord"
test     <- aggregate(list(mean_rc = sqrt((dat_all$pt11_X-dat_all$pt12_X)^2+(dat_all$pt11_Y-dat_all$pt12_Y)^2+(dat_all$pt11_Z-dat_all$pt12_Z)^2)),
by=list(species = dat_all$species, BirdID = dat_all$BirdID), mean)
test
dat_bird <- merge(dat_bird,test, by = c("species","BirdID"))
dat_all  <- merge(dat_all,test, by = c("species","BirdID"))
# uses scaling from:
# Alerstam, T., Rosén, M., Bäckman, J., Ericson, P. G., & Hellgren, O. (2007).
# Flight speeds among bird species: allometric and phylogenetic effects. PLoS Biol, 5(8), e197.
dat_all$prop_q_dot     <- (-(dat_all$full_CGx-dat_all$pt1_X)*dat_all$S_proj_max*dat_all$full_m^0.24)/(dat_all$full_Iyy)
dat_all$prop_q_dot_nd  <- (-(dat_all$full_CGx-dat_all$pt1_X)*dat_all$S_proj_max*dat_all$full_m^0.48)/(dat_all$full_Iyy*dat_all$mean_rc)
dat_all$del_M_specific <- dat_all$prop_q_dot*dat_all$full_Iyy/(dat_all$full_m*dat_all$mean_rc)
del_M_plot <- ggplot()+
geom_point(data = dat_all, aes(x = full_m, y = del_M_specific, col = species)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
del_M_plot
q_dot_plot <- ggplot()+
geom_point(data = dat_all, aes(x = full_m, y = prop_q_dot_nd, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
dat_all$prop_q_dot_nd  <- (-(dat_all$full_CGx-dat_all$pt1_X)*dat_all$S_proj_max*dat_all$full_m^0.48)/(dat_all$full_Iyy*dat_all$mean_rc^2)
q_dot_plot <- ggplot()+
geom_point(data = dat_all, aes(x = full_m, y = prop_q_dot_nd, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
plot(dat_all$torso_length,dat_all$mean_rc
)
del_M_plot <- ggplot()+
geom_point(data = dat_all, aes(x = torso_length, y = mean_rc, col = species)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
del_M_plot
View(dat_bird)
q_dot_plot <- ggplot()+
geom_point(data = dat_all, aes(x = full_m, y = prop_q_dot, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = prop_q_dot, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
del_M_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = del_M_specific, col = species)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = prop_q_dot_nd, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
dat_all$prop_q_dot_nd  <- (-(dat_all$full_CGx-dat_all$pt1_X)*dat_all$S_proj_max*dat_all$mean_rc^2)/(dat_all$full_Iyy)
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = prop_q_dot_nd, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
View(dat_bird)
View(dat_body)
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = -full_CGx, col = clade)) + th  +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
cg_plot
dat_all$full_CGx_specific <- (dat_all$full_CGx-dat_all$pt1_X)/dat_all$mean_rc
dat_all$full_CGz_specific <- (dat_all$full_CGz-dat_all$pt1_Z)/dat_all$mean_rc
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = -torso_CGx, col = clade)) + th  +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
cg_plot
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = -tail_CGx, col = clade)) + th  +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = -tail_CGx, col = clade)) + th  +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
cg_plot
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = -neck_CGx, col = clade)) + th  +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
cg_plot
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = neck_CGx, col = clade)) + th  +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
cg_plot
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = head_CGx, col = clade)) + th  +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
cg_plot
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = prop_q_dot_nd, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = neck_length, y = prop_q_dot_nd, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
dat_all$body_length_cm
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = neck_length/body_length_cm, y = prop_q_dot_nd, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = head_length/body_length_cm, y = prop_q_dot_nd, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = head_length/body_length_cm, y = prop_q_dot_nd, col = species)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = torso_length/body_length_cm, y = prop_q_dot_nd, col = species)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = prop_q_dot_nd, col = species)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = full_CGx_specific, col = clade)) + th  +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
cg_plot
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = -full_CGx_specific, col = clade)) + th  +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
cg_plot
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = full_CGx_specific, col = clade)) + th  +
scale_x_continuous(trans='log10')
cg_plot
aggregate(list(mean_rc = sqrt((dat_all$pt11_X-dat_all$pt12_X)^2+(dat_all$pt11_Y-dat_all$pt12_Y)^2+(dat_all$pt11_Z-dat_all$pt12_Z)^2)),
by=list(species = dat_all$species, BirdID = dat_all$BirdID), mean)
cg_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = torso_length, y = mean_rc, col = species)) + th  +
scale_x_continuous(trans='log10')
cg_plot
View(dat_feat)
dat_all$prop_q_dot_nd  <- (-(dat_all$full_CGx-dat_all$pt1_X)*dat_all$S_proj_max*dat_all$torso_length^2)/(dat_all$full_Iyy)
dat_all$del_M_specific <- dat_all$prop_q_dot*dat_all$full_Iyy/(dat_all$full_m*dat_all$torso_length)
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = prop_q_dot_nd, col = species)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
dat_all$prop_q_dot_nd  <- (-(dat_all$full_CGx-dat_all$pt1_X)*dat_all$S_proj_max*dat_all$body_length^2)/(dat_all$full_Iyy)
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = prop_q_dot_nd, col = species)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
dat_all$del_M_specific <- dat_all$prop_q_dot*dat_all$full_Iyy/(dat_all$full_m*dat_all$body_length)
del_M_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = del_M_specific, col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
del_M_plot
test <- lm(del_M_specific ~ elbow*manus+full_m, data = dat_all)
summary(test)
test <- lm(del_M_specific ~ elbow*manus+species+full_m, data = dat_all)
summary(test)
test <- lm(prop_q_dot_nd ~ elbow*manus+species+full_m, data = dat_all)
summary(test)
test <- lm(prop_q_dot_nd ~ elbow*manus+full_m, data = dat_all)
summary(test)
test <- lm(prop_q_dot_nd ~ elbow*manus+species+full_m, data = dat_all)
summary(test)
ROM_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = elbow, y = manus, col = prop_q_dot_nd)) + th + facet_wrap(~species)
ROM_plot
ROM_plot <- ggplot()+
geom_point(data = subset(dat_all, species == "fal_col"), aes(x = elbow, y = manus, col = prop_q_dot_nd)) + th
ROM_plot
ROM_plot <- ggplot()+
geom_point(data = subset(dat_all, species == "meg_alc"), aes(x = elbow, y = manus, col = prop_q_dot_nd)) + th
ROM_plot
ROM_plot <- ggplot()+
geom_point(data = subset(dat_all, species == "fal_per"), aes(x = elbow, y = manus, col = prop_q_dot_nd)) + th
ROM_plot
ROM_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = elbow, y = manus, col = prop_q_dot_nd)) + th + facet_wrap(~species)
ROM_plot
q_dot_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = prop_q_dot, col = species)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
q_dot_plot
Ixz_plot <- ggplot()+
geom_point(data = dat_all, aes(x = full_m, y = full_Ixz/(full_m*torso_length*body_height_max), col = clade)) + th +
scale_x_continuous(trans='log10')
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = full_Ixz/(full_m*torso_length*body_height_max), col = clade)) + th +
scale_x_continuous(trans='log10')
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_Ixx/(full_m*torso_length^2), y = full_Ixz/(full_m*torso_length^2), col = clade)) + th +
scale_x_continuous(trans='log10')
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_Izz/(full_m*torso_length^2), y = full_Ixz/(full_m*torso_length^2), col = clade)) + th +
scale_x_continuous(trans='log10')
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = abs(full_Ixz/full_Izz), col = clade)) + th +
scale_x_continuous(trans='log10')
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = abs(full_Ixz/full_Izz), col = clade)) + th +
scale_x_continuous(trans='log10')+
scale_y_continuous(trans='log10')
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = abs(full_Ixz/full_Izz), col = clade)) + th +
scale_x_continuous(trans='log10')
Ixz_plot
test <- lm(abs(full_Ixz/full_Izz) ~ elbow*manus+species+full_m, data = dat_all)
summary(test)
test <- lm((full_Ixz/full_Izz) ~ elbow*manus+species+full_m, data = dat_all)
summary(test)
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = abs(full_Ixz/full_Ixx), y = abs(full_Ixz/full_Izz), col = clade)) + th +
scale_x_continuous(trans='log10')
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = abs(full_Ixz/full_Ixx), y = abs(full_Ixz/full_Izz), col = clade)) + th
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = abs(full_Ixz/full_Ixx), y = abs(full_Ixz/full_Izz), col = clade)) + th + facet_wrap(~species)
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = abs(full_Ixz/full_Ixx), y = abs(full_Ixz/full_Izz), col = clade)) + th + facet_wrap(~clade)
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = abs(full_Ixz/full_Ixx), y = abs(full_Ixz/full_Izz), col = clade)) + th + facet_wrap(~clade)
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = abs(full_Ixz/full_Ixx), y = abs(full_Ixz/full_Izz), col = species)) + th + facet_wrap(~clade)+coord_fixed()
Ixz_plot
ROM_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = elbow, y = manus, col = abs(full_Ixz/full_Ixx))) + th + facet_wrap(~species)
ROM_plot
ROM_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = elbow, y = manus, col = abs(full_Ixz/full_Izz))) + th + facet_wrap(~species)
ROM_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = abs(wing_Ixz/full_Ixz_VRP), col = species)) + th + facet_wrap(~clade)+coord_fixed()
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = abs(wing_Ixz/full_VRP_Ixz), col = species)) + th + facet_wrap(~clade)+coord_fixed()
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = abs(wing_Ixz/full_VRP_Ixz), col = species)) + th + facet_wrap(~clade)
Ixz_plot
View(dat_all)
which.max(abs(dat_all$wing_Ixz/dat_all$full_Ixz))
dat_all[6278,]
test <- dat_all[6278,]
View(test)
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = wing_Ixz, col = species)) + th + facet_wrap(~clade)
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = wing_Ixz/(full_m*torso_length^2), col = species)) + th + facet_wrap(~clade)
Ixz_plot
Ixz_plot <- ggplot()+
geom_point(data = subset(dat_all, species != "oce_leu"), aes(x = full_m, y = wing_Ixz/(full_m*torso_length^2), col = species)) + th
Ixz_plot
test = FALSE
!test
